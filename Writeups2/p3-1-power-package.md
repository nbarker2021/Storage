# P3.1: Statistical Power Analysis Package

This package provides artifacts for Phase 3.1: comprehensive statistical power and confidence interval analysis of key embedding metrics.

## Artifacts

1. **Power Analysis Report PDF**: Detailed power calculations and confidence intervals
   - File: power_analysis_report.pdf
2. **Power Analysis Code**: Python script computing power and CIs
   - File: power_analysis.py

## power_analysis.py
```python
import numpy as np
import scipy.stats as st
import json

# Load distance data from RH invariance analysis
# Assume JSON with {variant:[(mean,std),...]}
with open('rh_results.json') as f:
    data = json.load(f)

def compute_ci(mean, sd, n, alpha=0.05):
    se = sd/np.sqrt(n)
    h = se * st.t.ppf(1-alpha/2, df=n-1)
    return mean-h, mean+h

report = {}
for variant, results in data.items():
    report[variant]=[]
    for mean, std in results:
        ci = compute_ci(mean,std,len(data[variant])*10000)
        report[variant].append({'mean':mean,'std':std,'95ci':ci})

# Power analysis for difference between base and shifted
base = [r[0] for r in report['base']]
shift = [r[0] for r in report['shift']]
diff = np.array(shift)-np.array(base)
m=diff.mean(); s=diff.std(ddof=1)
n=len(diff)
# Compute power
effect = m/s
power = st.ttest_power(effect, nobs=n, alpha=0.05)
report['power_diff_base_shift']={'effect_size':effect,'power':power}

# Save report
with open('power_analysis.json','w') as f:
    json.dump(report,f,indent=2)

print(json.dumps(report,indent=2))
```

## Instructions

1. Ensure `rh_results.json` is generated by `rh_analysis.py`.
2. Install dependencies: `pip install numpy scipy`
3. Run: `python power_analysis.py > power_analysis.json`
4. Open `power_analysis_report.pdf` for detailed results.
